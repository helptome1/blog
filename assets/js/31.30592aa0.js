(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{560:function(t,a,e){"use strict";e.r(a);var s=e(8),r=Object(s.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"解决-openlayers-矢量数据坐标系和地图服务坐标系不同的情况"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#解决-openlayers-矢量数据坐标系和地图服务坐标系不同的情况"}},[t._v("#")]),t._v(" 解决 Openlayers 矢量数据坐标系和地图服务坐标系不同的情况")]),t._v(" "),e("h2",{attrs:{id:"背景"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#背景"}},[t._v("#")]),t._v(" 背景")]),t._v(" "),e("p",[t._v("使用 openlayers 加载使用"),e("a",{attrs:{href:"https://datav.aliyun.com/portal/school/atlas/area_generator#15.87/104.059907/30.641388",target:"_blank",rel:"noopener noreferrer"}},[t._v("DataV.GeoAtlas"),e("OutboundLink")],1),t._v("生成的 geojson 文件时，在 EPSG:3857 投影方式的地图上出现了位置偏差的问题。")]),t._v(" "),e("p",[t._v("图中绿色框， 应该遮住四川华西医院。但是可以看到，偏离了本来的位置。")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://secure2.wostatic.cn/static/tN1aG4Ne9BVYd6ks66jPaw/image.png?auth_key=1679218675-tvkqzDMcLXdc3YkgHGk3uA-0-b14cf99bd38297c4dfeab4b9103b66a3",alt:"DataV.GeoAtals"}})]),t._v(" "),e("p",[e("img",{attrs:{src:"https://secure2.wostatic.cn/static/vfPNsyrWwN4bTWHnXqePub/image.png?auth_key=1679218675-qiGPUeD3Xo6s9ytDccE3jm-0-3a213689ceaca21668047ffc8d42d0ba",alt:"在使用EPSG:3857投影的地图上出现偏差"}})]),t._v(" "),e("h2",{attrs:{id:"问题出现的原因"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#问题出现的原因"}},[t._v("#")]),t._v(" 问题出现的原因：")]),t._v(" "),e("p",[t._v("使用 DataV.GeoAtalss 生成的 geojson 文件的坐标系仍然是 GCJ02。所以在 EPSG:3857 投影的坐标系上会出现位置的偏差。")]),t._v(" "),e("h2",{attrs:{id:"解决办法"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#解决办法"}},[t._v("#")]),t._v(" 解决办法：")]),t._v(" "),e("p",[t._v("两种解决方式：1. 使用"),e("a",{attrs:{href:"https://github.com/hujiulong/gcoord#api",target:"_blank",rel:"noopener noreferrer"}},[t._v("gcoord"),e("OutboundLink")],1),t._v("库文件，将 GCJ02 坐标系的 geojson 文件转换为 wsg84 坐标系的 geojson 文件。")]),t._v(" "),e("ol",[e("li",[t._v("使用"),e("a",{attrs:{href:"https://github.com/proj4js/proj4js",target:"_blank",rel:"noopener noreferrer"}},[t._v("proj4js "),e("OutboundLink")],1),t._v("库文件，使用 proj4.defs 方法定义拓展的 EPSG 坐标系。这样可以更优雅，但是需要研究一下。")])]),t._v(" "),e("p",[t._v("我目前使用第一种方式，直接转换 geojson 文件的坐标。也非常的方便。")]),t._v(" "),e("div",{staticClass:"language-Vue extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vue"}},[e("code",[t._v('    getGeoJson() {\n      axios.get("/show/sichuanUniversity.geojson").then((res) => {\n        const geojson = res.data;\n        gcoord.transform(geojson, gcoord.GCJ02, gcoord.WGS84);\n        this.addGeoJSON(geojson);\n      });\n    },\n')])])])])}),[],!1,null,null,null);a.default=r.exports}}]);